!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},o=(new e.Error).stack;o&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[o]="9eaf0c24-ee42-4cf0-94a0-c556e0ed97ee",e._sentryDebugIdIdentifier="sentry-dbid-9eaf0c24-ee42-4cf0-94a0-c556e0ed97ee")}catch(e){}}();"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8984],{58984:function(e,o,a){a.d(o,{I:function(){return p}});var t=a(65122),r=a(69762),l=a(43186),i=a(52983),n=a(33961),_=a(64458);let s=(e,o)=>{let a=d(e,o),t=c(e);if(!a)throw Error("There are no download parameters for ".concat(e.name," in ").concat(o));return{action:a,modifier:t}},d=(e,o)=>{var a;let t=null===(a=u[e.name])||void 0===a?void 0:a[o];if(!t)throw Error("There are no download parameters for ".concat(e.name," in ").concat(o));return t},c=e=>{if("workflow"===e.name){let o=w[e.subOption];if(!o)throw Error("There are no download parameters for workflow with ".concat(e.subOption));return o}},u={retouch:{detail:"ai_tool_retouch",postDownload:"ai_tool_retouch_after_download"},expand:{detail:"ai_tool_expand",postDownload:"ai_tool_expand_after_download"},reimagine:{detail:"ai_tool_reimagine",postDownload:"ai_tool_reimagine_after_download"},adjust:{detail:"ai_tool_adjust",postDownload:"ai_tool_adjust_after_download",thumbnail:"ai_tool_adjust_thumbnail"},replacebg:{detail:"ai_tool_replacebg"},video:{detail:"ai_tool_video",postDownload:"ai_tool_video_after_download"},assistant:{detail:"ai_tool_assistant",thumbnail:"ai_tool_assistant_thumbnail"},generatePrompt:{detail:"ai_tool_generate_prompt"},styleReference:{detail:"ai_tool_generate_style_ref",postDownload:"ai_tool_generate_style_ref_after_download",thumbnail:"ai_tool_generate_style_ref_thumbnail"},workflow:{detail:"ai_tool_assistant"},imageEditor:{thumbnail:"ai_tool_all_thumbnail",detail:"ai_tool_all",postDownload:"ai_tool_all_after_download"},useAsReference:{detail:"ai_tool_generate_use_as_reference",thumbnail:"ai_tool_generate_image_ref",postDownload:"ai_tool_generate_image_ref_after_download"},changeCamera:{detail:"ai_tool_change_camera",thumbnail:"ai_tool_change_camera_thumbnail",postDownload:"ai_tool_change_camera_after_download"},variations:{detail:"ai_tool_variations",thumbnail:"ai_tool_variations_thumbnail",postDownload:"ai_tool_variations_after_download"},cinematicShot:{detail:"ai_tool_cinematic_shot"}},w={createSocialPost:"workflow_create_post",createPoster:"workflow_create_poster",mixImages:"workflow_mix_images",applyPromo:"workflow_apply_promo",createFlyer:"workflow_create_flyer",createLogoVariations:"workflow_create_logo_variations",localize:"workflow_localize",createLogo:"workflow_create_logo",applyColors:"workflow_apply_colors",replaceText:"workflow_replace_text",removeText:"workflow_remove_text",replaceElement:"workflow_replace_element",addElement:"workflow_add_element"};var f=a(75045);let m=e=>{let{tool:o,location:a,imageSrc:t,resource:r}=e,{id:d,name:c,author:u,premium:w,type:m,isAIGenerated:p,preview:g,url:h}=r,{action:b,modifier:k}=s(o,a),y=(0,_.M)({tool:o,resource:{type:m,subtype:m,authorName:u.name,isPremium:w,isAIGenerated:p}}),{handleDownload:v}=(0,f.i)({resource:{id:d,name:c,author:u,premium:w,regularType:m,isAIGenerated:p,url:h,preview:g,type:m},action:b,modifier:k,showAttributionModal:!1,skipDownloadTracker:!0,location:(0,n.d)({isResourcePremium:w,tool:o,location:a}),checkoutQueryParams:y}),D=(0,l.J)(),T=null!=t?t:g.url;return(0,i.useCallback)(async()=>{let e=await v(T);if(!(null==e?void 0:e.signedUrl))throw Error("Failed to download image");return D(),"".concat(e.signedUrl,"&w=2000&h=2000")},[T,v,D])},p=e=>{let{tool:o,location:a,imageSrc:l,extraParams:i,resource:n}=e,{id:_,premium:s,isAIGenerated:d,type:c,author:{name:u},name:w,preview:{url:f,width:p,height:g}}=n,h=(0,t.e)(),b=m({tool:o,location:a,imageSrc:l,resource:n});return(0,r.F)({tool:o,resource:{id:_,name:w,type:c,authorName:u,isPremium:s,isAIGenerated:d,groupedType:"regular",media:{url:f,width:p,height:g}},canDownloadResource:h||!s,imageSrc:l,getSignedResource:b,location:a,extraParams:i})}},15715:function(e,o,a){a.d(o,{H:function(){return r}});let t=e=>{let{resource:o,file:a,option:t,size:r,action:l,walletId:i,locale:n,modifier:_,searchExpression:s}=e,d=new URLSearchParams;return d.set("resource","".concat(o)),a&&t?(d.set("file",a),d.set("option","".concat(t))):r&&d.set("size","".concat(r)),l&&d.set("action",l),i&&d.set("walletId",i),d.set("locale",n),_&&d.set("modifier",_),s&&d.set("searchExpression",s),d.toString()},r=async e=>{let o=t(e),a=await fetch("/api/regular/download?".concat(o));return a.ok?{success:!0,data:await a.json()}:429===a.status?{success:!1,data:"DOWNLOAD_LIMIT_REACHED",metadata:"/download-limit"}:401===a.status||403===a.status||405===a.status?{success:!1,data:"AUTHENTICATION_ERROR"}:404===a.status?{success:!1,data:"NOT_FOUND"}:{success:!1,data:"UNKNOWN_ERROR"}}},75045:function(e,o,a){a.d(o,{i:function(){return R}});var t=a(72234),r=a(15880),l=a(68147),i=a(85229),n=a(25983),_=a(59608),s=a(52983),d=a(9036),c=a(35576),u=a(7526);let w=(e,o)=>o||("photo"===e?"jpg":"zip");var f=a(24278);a(97458);let m=(0,s.createContext)(null),p=()=>(0,s.useContext)(m)||{shouldTrackingLog:!0};var g=a(15715),h=a(32509),b=a(72661),k=a(72118),y=a(1850),v=a(64979),D=a(56879);let T=y.z.enum(["download","copy","edit","prompt","preview","remove_background","remove_background_edit","ai_video",v.cm,v.PF,v.p3,v.Kq,v.wK,v.os,v.H$,v.C0,v.u4,v.OI,v.Iu,v.e5,"ai_tool_retouch","ai_tool_retouch_after_download","ai_tool_expand","ai_tool_expand_after_download","ai_tool_reimagine","ai_tool_reimagine_after_download","ai_tool_adjust","ai_tool_adjust_after_download","ai_tool_replacebg","ai_tool_video","ai_tool_video_after_download","ai_tool_assistant","ai_tool_generate_prompt","ai_tool_generate_style_ref","ai_tool_generate_style_ref_after_download","ai_tool_generate_style_ref_thumbnail","ai_tool_adjust_thumbnail","ai_tool_assistant_thumbnail","ai_tool_all_thumbnail","ai_tool_all","ai_tool_generate_image_ref","ai_tool_all_after_download","ai_tool_generate_image_ref_after_download","ai_tool_generate_use_as_reference","ai_tool_variations","ai_tool_variations_thumbnail","ai_tool_change_camera","ai_tool_change_camera_thumbnail","ai_tool_change_camera_after_download","ai_tool_variations_after_download","ai_tool_cinematic_shot"]),z=y.z.enum(["workflow_create_post","workflow_create_poster","workflow_mix_images","workflow_apply_promo","workflow_create_flyer","workflow_create_logo_variations","workflow_localize","workflow_create_logo","workflow_apply_colors","workflow_replace_text","workflow_remove_text","workflow_replace_element","workflow_add_element"]);y.z.object({resource:y.z.coerce.number(),file:D.ru.optional(),option:y.z.coerce.number().optional(),size:y.z.coerce.number().optional(),action:T.optional(),modifier:z.optional(),walletId:y.z.string().nullable().optional(),locale:y.z.string(),searchExpression:y.z.string().optional()}),y.z.object({data:y.z.object({filename:y.z.string(),url:y.z.string(),prompt:y.z.string().optional(),signed_url:y.z.string().optional()})}).transform(e=>{let{data:o}=e;return o}).transform(e=>{let{signed_url:o,...a}=e;return{...a,signedUrl:o}});let I=y.z.array(y.z.string()),x=new Date(new Date().getTime()+48e4),N=k.Z.withConverter({write:e=>e}),E=e=>{try{let o=N.get(e);if(!o)return[];return I.parse(JSON.parse(o))}catch(e){return[]}},O=()=>{let e=(0,l.I)(),o=(0,b.b)();return(0,s.useCallback)(a=>{if(!e)return;let t="".concat("ck_items_").concat(e),r=E(t),l="".concat(a);if(!r.includes(l)){let e=JSON.stringify([...r,l]);N.set(t,e,{path:"/",domain:o,expires:x})}},[e,o])},R=e=>{let{resource:o,file:a,action:m="download",modifier:b,location:k="resource_detail",option:y,size:v,showAttributionModal:D=!0,handleError:T,checkoutQueryParams:z,skipDownloadTracker:I=!1,searchExpression:x}=e,{id:N,name:E,author:R,premium:C,regularType:U,isAIGenerated:j,url:A,type:L}=o,[H,P]=(0,s.useState)(!1),{isUserWinback:S,showWinbackModal:F}=(0,i.l)(),{showAttribution:W}=(0,f.tc)(),K=O(),M=(0,h.b)({resource:o,location:k}),G=(0,c.mS)(),{shouldTrackingLog:J}=p(),{showDeviceBlockedModal:q,isDeviceBlocked:Z}=(0,r.qx)(),$=(0,t.Lh)(),V=(0,l.I)(),B=(0,n.ZK)(),Q=(0,d.TH)({file_extension:w(U,a),file_name:E,file_id:N,license:C?"premium":"free",resolution:v?u.w8[v]:"original",style:"na",author_name:R.name,category:j?"ai_image":U,action:"prompt"===m?"view_prompt":m,location:k,url_link:A}),X=(0,s.useCallback)(e=>{if(T){T(e);return}"prompt"!==m&&M(e,z)},[T,m,M,z]);return{handleDownload:(0,s.useCallback)(async(e,o)=>{if(Z){q();return}if(S){F();return}P(!0),$||_.uT("WARNING: User ".concat(V," has no wallet_id"),"warning"),J&&!I&&G({resourceId:N,isResourcePremium:C,resourceType:L,downloadType:m,fileType:L,variant:k});let t=await (0,g.H)({resource:N,size:v?2e3:void 0,action:m,modifier:b,file:a,option:y,walletId:$,locale:B,searchExpression:x});if(t.success)return D&&W&&W(),P(!1),K(N),Q({externalUrl:null!=e?e:A,setting:o}),t.data;X(t),P(!1)},[Z,S,$,J,I,N,v,m,b,a,y,B,x,X,q,F,V,G,C,L,k,D,W,K,Q,A]),isDownloading:H}}},32509:function(e,o,a){a.d(o,{b:function(){return n}});var t=a(19170),r=a(10893),l=a(52983),i=a(65724);let n=e=>{var o;let{location:a,resource:n}=null!=e?e:{},{t:_}=(0,r.$G)("error"),{openToast:s}=(0,t.x_)(),d=(0,i.W)(null!==(o=null==n?void 0:n.id)&&void 0!==o?o:0,"",a);return(0,l.useCallback)((e,o)=>{if("DOWNLOAD_LIMIT_REACHED"===e.data&&n){d({resourceData:{name:n.name,mediaUrl:n.preview.url,mediaWidth:n.preview.width,mediaHeight:n.preview.height,resourceType:"regular"},checkoutQueryParams:o,modalType:"downloadLimit",origin:"download_limit"});return}if("AUTHENTICATION_ERROR"===e.data){window.location.href="/oauth-logout";return}"NOT_FOUND"===e.data&&s({type:"danger",message:_("notFound")}),"UNKNOWN_ERROR"===e.data&&s({type:"danger",message:_("unknown")})},[d,s,n,_])}}}]);